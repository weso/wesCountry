function SortedArray(){var t=0;this.array=[];for(var f=arguments.length;t<f;)this.insert(arguments[t++]);this.length=0;this.insert=function(d){var g=this.array,f=g.length;g.push(d);for(this.length=this.array.length;f;){d=f;var k=--f;if(g[d]<g[k]){var h=g[d];g[d]=g[k];g[k]=h}}return this};this.get=function(d){return this.array[d]};this.getArray=function(){return this.array};this.uniqueInsert=function(d){-1==this.search(d)&&this.insert(d)};this.search=function(d){for(var g=0,f=this.array,k=f.length;k>
g;){var h=(k+g)/2>>>0,u=f[h];if(u<d)g=h+1;else if(u>d)k=h;else return h}return-1};this.remove=function(d){d=this.search(d);0<=d&&this.array.splice(d,1);this.length=this.array.length;return this}}"undefined"===typeof exports&&(exports={});
var Selector=exports.Selector=function(t,f){function d(a,b,c,n,k){var h=document.createElement("ul");h.className=f["ul-class"];a.sort(function(a,b){return a.label<b.label?-1:a.label>b.label?1:0});for(var u=a.length,t=null,q=!1,r=[],x=0;x<u;x++){var m=a[x],s=m.children&&m.children.length?m.children.length:0,l=document.createElement("li");h.appendChild(l);l.code=m.code;l.liParent=b;l.data=m;l.isSelected=!1;var e=document.createElement("a");e.href="javascript: void(0)";e.value=m.label;-1!=f.selectedItems.indexOf(l.code)&&
(q=!0,r.push(e));null==k&&z.push(e);e.previousSiblingLink=n;e.nextSiblingLink=null;e.parentLink=k;n&&(n.nextSiblingLink=e);0==x&&(t=e);e.className="circleAndText";l.appendChild(e);e.liParent=l;e.onclick=function(a){y(this.liParent,f.callback);a&&a.stopPropagation()};var v=document.createElement("div");v.className=0<s?"plusOrMinus":"hidden-plusOrMinus";v.innerHTML="+";e.appendChild(v);0<s&&(v.onclick=function(a){g(this);a.stopPropagation()});e.plusOrMinus=v;e.onkeydown=function(a){if(13==a.keyCode)return y(this.liParent,
f.callback),a.stopPropagation(),!1;if(38==a.keyCode)return this.previousSiblingLink&&this.previousSiblingLink.focus(),a.stopPropagation(),!1;if(40==a.keyCode)return this.plusOrMinus.opened&&this.firstChildLink?this.firstChildLink.focus():this.nextSiblingLink?this.nextSiblingLink.focus():this.parentLink.nextSiblingLink&&this.parentLink.nextSiblingLink.focus(),a.stopPropagation(),!1;if(37==a.keyCode||39==a.keyCode)return a.stopPropagation(),g(this.plusOrMinus),a.keyCode=9,a.keyCode};var p=document.createElement("div");
p.className="circle";e.appendChild(p);n=document.createElement("div");n.className="title";e.appendChild(n);var w=document.createTextNode(m.label);n.appendChild(w);n=e;0<s&&(s=document.createElement("span"),s.className="empty-counter",p.appendChild(s),w=document.createTextNode("0"),s.appendChild(w),l.counter={div:s,value:0},p=d(m.children,l,c+1,n,e),l.appendChild(p.ul),e.firstChildLink=p.firstChildLink,v.childrenUl=p.ul,!0==p.selected&&(q=!0,v.innerHTML="-"),r=r.concat(p.selectedItems));l.childNumber=
m.children?m.children.length:0}1<c&&!1==q&&(h.style.display="none");return{ul:h,firstChildLink:t,selected:q,selectedItems:r}}function g(a){"+"==a.innerHTML?(a.innerHTML="&#8212;",a.childrenUl&&(a.childrenUl.style.display="block"),a.opened=!0):(a.innerHTML="+",a.childrenUl&&(a.childrenUl.style.display="none"),a.opened=!1)}function y(a,b){var c=!a.isSelected;c&&0<f.maxSelectedItems&&q.length>=f.maxSelectedItems||k(a,b,c)}function k(a,b,c){h(a,c);if(a.liParent){var d=a.liParent.counter.value,d=c?d+1:
d-1;u(a.liParent,d);c?d==a.liParent.childNumber&&(a.liParent.className="selected",a.liParent.isSelected=!0,w(a.liParent.code,!0)):(a.liParent.className="not-selected",a.liParent.isSelected=!1,w(a.liParent.code,!1))}0<a.childNumber&&u(a,c?a.childNumber:0);b&&b.call(a,a.data,q)}function h(a,b){"li"==a.tagName.toLowerCase()&&(a.isSelected=b,a.className=b?"selected":"not-selected",w(a.code,b),a.firstChild.title=a.firstChild.value+(b?" is selected":""));for(var c=a&&a.children&&a.children.length?a.children.length:
0,d=0;d<c;d++)h(a.children[d],b)}function u(a,b){var c=a.counter;c.value=b;c.div.innerHTML=c.value;c.div.className=0<c.value?"counter":"empty-counter";b=a.firstChild.value;a.firstChild.title=b+": "+c.value+(1!=c.value?" selected countries":" selected country")}function w(a,b){a&&(b?q.uniqueInsert(a):q.remove(a))}function A(a,b){if(b instanceof Array)return b;if("object"===typeof b){for(var c in b)a[c]=A(a[c],b[c]);return a}return b}var B={"ul-class":"default-selector",callback:null,maxSelectedItems:-1,
selectedItems:[]},z=[],q=new SortedArray,r=null;(function(){var a=f;if(a){"string"===typeof a&&(a={container:a});var b=JSON.parse(JSON.stringify(B)),c;for(c in a)b[c]=A(b[c],a[c]);a=b}else a=JSON.parse(JSON.stringify(B));f=a;a=d(t,null,1,null,null);r=a.ul;a=a.selectedItems;b=a.length;for(c=0;c<b;c++)a[c].onclick()})();this.render=function(){return r};this.clear=function(){for(var a=r.children.length,b=0;b<a;b++)k(r.children[b],null,!1)};this.selectAll=function(){for(var a=z.length,b=0;b<a;b++)y(z[b].liParent,
null)}};
